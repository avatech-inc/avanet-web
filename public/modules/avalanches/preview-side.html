<section ng-controller="AvalanchePreviewController">
<style>


.sectionHeader {
	padding-left: 14px;
	font-size:18px;
	font-weight:bold;
	margin-bottom:5px;
	margin-top:10px;
}
.popupHeader {
	height: 44px;
	position: relative;
	padding-left: 14px;
	background: #eee;
	z-index:1000;
}
.popupHeader .title {
	font-size: 20px;
	font-weight:100;
	line-height: 45px;
	float:left;
}
.buttons > div {
	display: inline-block;
	float:left;
}
.buttons {
	display: inline-block;
	float:right;
}


.photos {
	margin-top: 14px;
	margin-bottom: 8px;
}
.photos .image-container {
	position: relative;
	cursor: pointer;
	margin:0px 7px;
}
.photos .image-container img {
	height: 130px;
}
.photos .image-container:before {
    display:block;
    content:'';
    position:absolute;
    width:100%;
    height:100%;
    -moz-box-shadow:inset 0px 0px 0px 1px rgba(0,0,0,0.15);
    -webkit-box-shadow:inset 0px 0px 0px 1px rgba(0,0,0,0.15);
    box-shadow:inset 0px 0px 0px 1px rgba(0,0,0,0.15);
}
.photos .image-container:hover:before {
    -moz-box-shadow:inset 0px 0px 0px 1px rgba(0,0,0,0.5);
    -webkit-box-shadow:inset 0px 0px 0px 1px rgba(0,0,0,0.5);
    box-shadow:inset 0px 0px 0px 1px rgba(0,0,0,0.5);
}

.headshot {
	background: #aaa;
	height:40px;
	width:40px;
	border-radius: 100px;
}

/*--------------------------------------------------*/

.subheader { 
	font-weight:bold;
	margin-bottom:8px;
	color:#777;
}
</style>

<div class="popupHeader">

	<div class="title">Avalanche<span ng-show="discussMode" style="color:#999;">&nbsp;&nbsp;/&nbsp;&nbsp;Discuss</span></div>
	<div class="buttons">
		<div ng-show="observation">

			<div class="btn-group filter right" ng-hide="discussMode">
		      <button type="button" ng-click="discussMode = !discussMode"><i class="ion-chatboxes"></i>&nbsp;&nbsp;Discuss
		      </button>
	      	</div>
			<div class="btn-group filter right" ng-show="discussMode">
		      <button type="button" ng-click="discussMode = !discussMode"><i class="ion-ios-arrow-back"></i>&nbsp;&nbsp;Back to profile
		      </button>
	      	</div>

		    <div class="btn-group filter right" ng-if="global.user._id == observation.user._id" ng-hide="discussMode">
		      <button ng-click="go('/avalanches/' + observation._id)"><i class="fa fa-pencil"></i>&nbsp;&nbsp;Edit</span></button>
		    </div>
	    </div>

		<div class="btn-group filter right">
		  <button type="button" ng-click="close()">
			<i class="ion-close-round"></i>
		  </button>
		</div>

	</div>

</div>

<div ng-hide="observation" style="padding:15px;">
Loading...
</div>

<div style="font-size:14px;line-height:20px; background:#fff; position:absolute; top:44px; bottom:0; right:0; left:0; box-shadow: 0px 0px 8px rgba(0,0,0,.25); z-index:999;" ng-show="observation"
scrollable always-visible="true">

<div ng-hide="discussMode">

	<div style="background:#fff;padding:6px;height:52px;border-bottom:1px solid #eee;">
		<div class="headshot" style="float:left;margin-right:9px;"></div>
		<div style="font-size:17px;margin-top:2px;">{{ observation.user.fullName }}</div>
		<div style="font-size:14px;color:#888;">{{ formatters.formatOrg(observation.organization) }}</div>
	</div>

	<div style="font-size:13px;padding-left:12px;display:inline-block;padding-right:14px;border-right:1px solid #eee;padding-top:4px;padding-bottom:4px;">
		<!--<i class="fa fa-clock-o" style="vertical-align:top;color:#aaa;margin-top:4px;margin-right:12px;float:left;font-size:30px;"></i>-->
		<div style='display:inline-block;line-height:18px;vertical-align:top;'>
		<b>Date & Time</b><br/>
		{{observation.date | date:'M/d/yy'}} {{observation.time | date:'h:mm a'}}
		</div>
	</div>

	<div style="font-size:13px;display:inline-block;padding-left:8px;padding-top:4px;padding-bottom:4px;padding-right:14px;border-right:1px solid #eee;">
		<!--<i class="fa fa-compass" style="vertical-align:top;color:#aaa;margin-top:4px;margin-right:12px;float:left;font-size:30px;"></i>-->
		<div style='display:inline-block;line-height:18px;vertical-align:top;'>
		<b>Elevation</b><br/>
		{{ formatters.formatElevation(observation.elevation) }}
		</div>
	</div>
	<div style="font-size:13px;display:inline-block;padding-left:8px;padding-top:4px;padding-bottom:4px;padding-right:14px;border-right:1px solid #eee;">
		<!--<i class="fa fa-compass" style="vertical-align:top;color:#aaa;margin-top:4px;margin-right:12px;float:left;font-size:30px;"></i>-->
		<div style='display:inline-block;line-height:18px;vertical-align:top;'>
		<b>Slope</b><br/>
		{{ formatters.formatSlope(observation.slope) }}
		</div>
	</div>
	<div style="font-size:13px;display:inline-block;padding-left:8px;padding-top:4px;padding-bottom:4px;border-right:1px solid #eee;padding-right:14px;">
		<!--<i class="fa fa-compass" style="vertical-align:top;color:#aaa;margin-top:4px;margin-right:12px;float:left;font-size:30px;"></i>-->
		<div style='display:inline-block;line-height:18px;vertical-align:top;'>
		<b>Aspect</b><br/>
		{{ formatters.formatDirection(observation.aspect) }}
		</div>
	</div>

	<div style="font-size:13px;display:inline-block;padding-left:8px;padding-top:4px;padding-bottom:4px;padding-right:14px;border-right:0px solid #eee;">
		<!--<i class="fa fa-location-arrow" style="vertical-align:top;color:#aaa;margin-top:4px;margin-right:12px;float:left;font-size:30px;"></i>-->
		<div style='display:inline-block;line-height:18px;vertical-align:top;'>
		<b>Location</b><br/>
		{{ formatters.format(observation.locationName) }}<br/>
		<!--{{ formatters.formatLatLng(profile.location) }}-->
		</div>
	</div>
	<div style="clear:both;border-bottom:1px solid #eee;"></div>

		<div style="padding:14px;">
			Avalanche Type: <b>{{ avalancheTypes[observation.avalancheType] }}</b><br/>
			Trigger: <b>{{ observation.trigger ? avalancheTriggers[observation.trigger] : '--' }}</b><br/>
			<div ng-show="observation.secondaryTriggers"><b>{{ getTriggerNames(observation.secondaryTriggers) }}</b></div>
			<br/>

			<div style="float:left;">
				<div class="subheader">Avalanche Size</div>

				Relative: <b>{{ observation.sizeRelative ? observation.sizeRelative : '--' }}</b><br/>
				Destructive: <b>{{ observation.sizeDestructive ? observation.sizeDestructive : '--' }}</b><br/><br/>

				<div class="subheader">Avalanche Dimensions</div>

				Slab Thickness: <b>{{ formatters.formatCmOrIn(observation.slabThickness) }}</b><br/>
				Slab Width: <b>{{ formatters.formatMetersOrFeet(observation.slabWidth) }}</b><br/>
				Vertical Fall: <b>{{ formatters.formatMetersOrFeet(observation.slabVertical) }}</b><br/><br/>
			</div>
			<div style="float:left;margin-left:40px;">
				<div class="subheader">People Involved</div>

				Caught: <b>{{ observation.peopleCaught }}</b><br/>
				Carried: <b>{{ observation.peopleCarried }}</b><br/>
				Buried - Partially: <b>{{ observation.peopleBuriedPartially }}</b><br/>
				Buried - Fully: <b>{{ observation.peopleBurriedFully }}</b><br/>
				Injured: <b>{{ observation.peopleInjured }}</b><br/>
				Killed: <b>{{ observation.peopleKilled }}</b><br/>

			</div>
		</div>

	<!-- notes -->
	<div ng-show="observation.notes && observation.notes != ''">
		<div style="clear:both;border-bottom:1px solid #eee;"></div>
		<div class="sectionHeader">Notes</div>
		<div style="font-size:13px;padding:5px 20px 14px 14px;font-weight:100;line-height:16px;">{{ observation.notes }}</div>
	</div>

	<!-- photos -->
	<div ng-show="observation.photos && observation.photos.length > 0">
		<div style="clear:both;border-bottom:1px solid #eee;"></div>
		<div class="sectionHeader">Photos</div>
		<div class="photos" style="height: 145px; overflow-y: scroll; white-space: nowrap;padding-left:7px;">
			<div ng-repeat="photo in observation.photos" style="vertical-align:top;display:inline-block;" ng-click="showPhoto($index)">
				<div class="image-container">
					<img src="{{ photo.url }}"/>
				</div>

				<!--<span style='font-size:11px;'>{{ photo.caption }}</span>-->
			</div>
		</div>
	</div>

</div>

<div ng-show="discussMode">

	<div style="position:relative;margin-left:14px;margin-right:20px;margin-bottom:12px;padding-top:6px;">
		<comments-new ng-show="observation" owner-type="'observation'" owner-id="observationId"></comments-new>
	</div>
</div>

</div>

</div>

</section>
